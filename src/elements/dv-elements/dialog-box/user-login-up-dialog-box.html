<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">

<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">


<dom-module id="user-login-up-dialog-box">
    <template>
        <style>
            :host{
                display: block;
                @apply(--layout-vertical);
                min-height: 170px;
                min-width: 300px;
            }
            .flex {
                @apply(--layout-flex);
                align-content: center;
            }
            .create {
                background-color: #3284e1;
                color: white !important;
            }
            paper-input [prefix] {
                margin-right: 13px !important;
            }
            paper-toolbar {
                margin-left: -25px !important;
                margin-right: -25px !important;
                margin-top: -25px !important;
            }
            .userLoginIcon {
                text-align: center;
            }
            .userLoginIcon > iron-icon {
                width: 5em !important;
                height: 5em !important;
            }
        </style>
        <div>
            <paper-toolbar>
                <div class="title">Sign in</div>
                <paper-icon-button icon="close" dialog-dismiss></paper-icon-button>
            </paper-toolbar>
        </div>
        <br>
        <div class="flex">
            <div class="userLoginIcon">
                <iron-icon icon="icons:account-circle"></iron-icon>
            </div>

            <paper-input id="username" label="username" value="{{userName}}" type="text" required auto-validate error-message="supply your username!">
                <iron-icon icon="icons:face" prefix></iron-icon>
            </paper-input>

            <paper-input id="password" label="password" value="{{password}}" type="password" required auto-validate error-message="supply your password!">
                <iron-icon icon="communication:vpn-key" prefix></iron-icon>
            </paper-input>
        </div>
        <br>
        <div class="buttons">
            <!-- <paper-button dialog-dismiss>Cancel</paper-button> -->
            <paper-button class="create" on-tap="_signin" raised>Sign in</paper-button>
        </div>
    </template>
    <script>
        UserLoginUpDialogBox = Polymer
        ({
            is: 'user-login-up-dialog-box',

            properties: {
                userName: {
                    type: String,
                    notify: true
                },
                password: {
                    type: String,
                    notify: true
                }
            },

            //  EventHandlers Functions
            //================================
            _signin: function()
            {
                //FIXME: convert the suply name and password to base64 and store it to the session storage
                var a = Polymer.dom(this.root).querySelector('#username').validate();
                var b = Polymer.dom(this.root).querySelector('#password').validate();

                if ( a == false || b == false) {
                    return;
                }
                up = this.userName + ":" + this.password;
                var bs64Encode = window.btoa(up);
                //console.log(bs64Encode);
                sessionStorage.setItem("upauth", bs64Encode);

                //then,
                window.location.reload();
            }
        });
    </script>
</dom-module>