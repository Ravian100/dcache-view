<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../utils/ajax-ls/view-file.html">

<dom-module id="pagination-button">
    <style>
        :host{
            display: inline-block;
            /*Prevent text selection after double click*/
            -webkit-user-select: none; /* webkit (safari, chrome) browsers */
            -moz-user-select: none; /* mozilla browsers */
            -khtml-user-select: none; /* webkit (konqueror) browsers */
            -ms-user-select: none; /* IE10+ */
        }
        div {
            display: inline;
        }
        a {
            color: black;
            float: left;
            padding: 8px 16px;
            text-decoration: none;
            border: 1px solid #fafafa;
            transition: background-color .3s;
            font-size: 13px;
            background-color: #fafafa;
            border-radius: 3px;
            margin: 0 1px;
        }
        a.active {
            background-color: #fff;
            color: #000;
            border: 1px solid #b9babb;
        }
        a:hover:not(.active) {
            background-color: #efefef;
            cursor:pointer;
            border: 1px solid #f44336;
        }

    </style>
    <template>
        <div><a on-tap="_ref">{{dirName}}</a></div>
    </template>
    <script>
        PaginationButton = Polymer({
            is: 'pagination-button',

            properties: {
                dirName: {
                    type: String,
                    notify: true
                },

                canonicalPath: {
                    type: String,
                    notify: true
                },

                active: {
                    type: String,
                    notify: true,
                    value: false,
                    observer: '_activeChanged'
                }
            },

            factoryImpl: function(dirName, canonicalPath)
            {
                this.dirName = dirName;
                this.canonicalPath = canonicalPath;
            },

            _ref: function()
            {
                /**
                 * TODO: Factor-out this code.
                 * This code is similar to the _openFileLoc function in the
                 * list-row event element.
                 */
                p = this.canonicalPath;
                app.$.homedir.innerHTML = "";
                app.$.selectedTitle.querySelector("#pagination").innerHTML = "";

                var elRoot = new PaginationButton("Root", "/");
                if ( p == "/") {
                    elRoot.querySelector('a').classList.add("active");
                    app.$.selectedTitle.querySelector("#pagination").appendChild(elRoot);
                } else {
                    elRoot.querySelector('a').classList.remove("active");
                    app.$.selectedTitle.querySelector("#pagination").appendChild(elRoot);
                    var dirNames = p.split("/");
                    var pt =  "";
                    for (var i = 1; i < dirNames.length; i++) {
                        pt += "/" + dirNames[i];
                        var el = new PaginationButton(dirNames[i], pt);
                        el.querySelector('a').classList.remove("active");
                        if ( i == (dirNames.length-1) ) {
                            el.querySelector('a').classList.add("active");
                        }
                        app.$.selectedTitle.querySelector("#pagination").appendChild(el);
                    }
                }

                el1 = new ViewFile(p);
                app.$.homedir.appendChild(el1);
            },

            _activeChanged: function ()
            {
                this.querySelector('a').classList.add("active");
            }
        });
    </script>
</dom-module>